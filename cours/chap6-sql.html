<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chapitre 6 - Le langage SQL</title>
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
  <header class="topbar">
    <nav class="breadcrumb">
      <a href="../index.html" aria-label="Accueil">üè†</a>
      <span>/</span><a href="../index.html">Acad√©mie</a>
      <span>/</span><a href="index.html">Cours Bases de donn√©es</a>
      <span>/</span><span>Chapitre 6 : Le langage SQL</span>
    </nav>
  </header>

  <main class="layout">
    <article class="content">
      <div class="meta">
        <span>Temps de lecture approximative :</span>
        <span class="badge" id="readingTime">‚Äî</span>
      </div>

      <h1 id="chap6">Chapitre 6 : Le langage SQL</h1>

      <p>
        Le <strong>SQL (Structured Query Language)</strong> est le langage standard utilis√© pour :
      </p>
      <ul>
        <li><strong>d√©finir</strong> la structure d‚Äôune base de donn√©es (tables, contraintes‚Ä¶)</li>
        <li><strong>manipuler</strong> les donn√©es (ajouter, modifier, supprimer, consulter)</li>
        <li><strong>interroger</strong> les donn√©es avec des requ√™tes (SELECT, JOIN, GROUP BY‚Ä¶)</li>
      </ul>

      <p>On distingue principalement :</p>
      <ul>
        <li><strong>DDL</strong> (Data Definition Language) : d√©finition des objets</li>
        <li><strong>DML</strong> (Data Manipulation Language) : manipulation des donn√©es</li>
        <li>(souvent aussi <strong>DCL</strong> : droits, et <strong>TCL</strong> : transactions ‚Äî ici on se limite au programme)</li>
      </ul>

      <div class="callout good">
        <strong>Objectifs</strong><br/>
        Comprendre DDL/DML, √©crire des requ√™tes SELECT (filtrage, jointures, sous-requ√™tes),
        utiliser GROUP BY / HAVING, et appliquer les contraintes (PK/FK/UNIQUE/CHECK).
      </div>

      <h2 id="ddl">1) SQL de d√©finition (DDL)</h2>

      <h3 id="create">1.1 CREATE : cr√©er une base, une table</h3>

      <h4 id="create-db">Cr√©er une base de donn√©es</h4>
      <pre><code class="language-sql">CREATE DATABASE Universite;</code></pre>

      <h4 id="create-table">Cr√©er une table</h4>
      <pre><code class="language-sql">CREATE TABLE ETUDIANT (
  NumEtu INT PRIMARY KEY,
  Nom VARCHAR(50) NOT NULL,
  Prenom VARCHAR(50),
  DateNaissance DATE,
  CodeFiliere VARCHAR(10)
);</code></pre>

      <div class="callout good">
        <strong>Remarques</strong><br/>
        <ul>
          <li><code>NumEtu</code> est une <strong>cl√© primaire</strong></li>
          <li><code>Nom</code> est <strong>obligatoire</strong> gr√¢ce √† <code>NOT NULL</code></li>
        </ul>
      </div>

      <h3 id="alter">1.2 ALTER : modifier une table</h3>

      <h4 id="alter-add-column">Ajouter une colonne</h4>
      <pre><code class="language-sql">ALTER TABLE ETUDIANT
ADD Email VARCHAR(100);</code></pre>

      <h4 id="alter-modify-type">Modifier le type d‚Äôune colonne</h4>
      <pre><code class="language-sql">ALTER TABLE ETUDIANT
ALTER COLUMN Email TYPE VARCHAR(150);</code></pre>

      <div class="callout warn">
        <strong>Attention</strong><br/>
        La syntaxe d√©pend parfois du SGBD (MySQL, PostgreSQL, SQL Server‚Ä¶).
      </div>

      <h4 id="alter-add-constraint">Ajouter une contrainte</h4>
      <pre><code class="language-sql">ALTER TABLE ETUDIANT
ADD CONSTRAINT uq_email UNIQUE (Email);</code></pre>

      <h3 id="drop">1.3 DROP : supprimer un objet</h3>

      <h4 id="drop-table">Supprimer une table</h4>
      <pre><code class="language-sql">DROP TABLE ETUDIANT;</code></pre>

      <h4 id="drop-db">Supprimer une base</h4>
      <pre><code class="language-sql">DROP DATABASE Universite;</code></pre>

      <div class="callout warn">
        <strong>Attention</strong><br/>
        <code>DROP</code> supprime <strong>d√©finitivement</strong> les donn√©es.
      </div>

      <h2 id="dml">2) SQL de manipulation (DML)</h2>

      <h3 id="insert">2.1 INSERT : ajouter des donn√©es</h3>
      <pre><code class="language-sql">INSERT INTO ETUDIANT (NumEtu, Nom, Prenom, CodeFiliere)
VALUES (2024001, 'Alami', 'Hassan', 'INFO');</code></pre>

      <p>Ajouter plusieurs lignes :</p>
      <pre><code class="language-sql">INSERT INTO ETUDIANT VALUES
(2024002, 'Bennani', 'Fatima', '2002-08-22', 'GESTION'),
(2024003, 'Chakir', 'Ahmed', '2003-12-10', 'INFO');</code></pre>

      <h3 id="update">2.2 UPDATE : modifier des donn√©es</h3>
      <pre><code class="language-sql">UPDATE ETUDIANT
SET CodeFiliere = 'GESTION'
WHERE NumEtu = 2024003;</code></pre>

      <div class="callout warn">
        <strong>Important</strong><br/>
        Sans <code>WHERE</code> ‚Üí la requ√™te modifie <strong>toute la table</strong>.
      </div>

      <h3 id="delete">2.3 DELETE : supprimer des donn√©es</h3>
      <pre><code class="language-sql">DELETE FROM ETUDIANT
WHERE NumEtu = 2024002;</code></pre>

      <div class="callout warn">
        <strong>Important</strong><br/>
        Sans <code>WHERE</code> ‚Üí la requ√™te supprime <strong>toutes les lignes</strong>.
      </div>

      <h3 id="select">2.4 SELECT : interroger les donn√©es</h3>

      <h4 id="select-simple">S√©lection simple</h4>
      <pre><code class="language-sql">SELECT * FROM ETUDIANT;</code></pre>

      <h4 id="select-columns">Choisir des colonnes</h4>
      <pre><code class="language-sql">SELECT Nom, Prenom FROM ETUDIANT;</code></pre>

      <h4 id="select-distinct">DISTINCT (supprimer doublons)</h4>
      <pre><code class="language-sql">SELECT DISTINCT CodeFiliere FROM ETUDIANT;</code></pre>

      <h2 id="filtrage-join-sub">3) Filtrage : WHERE, JOIN, Sous-requ√™tes</h2>

      <h3 id="where">3.1 WHERE : filtrer les lignes</h3>
      <pre><code class="language-sql">SELECT *
FROM ETUDIANT
WHERE CodeFiliere = 'INFO';</code></pre>

      <p>Conditions utiles :</p>
      <ul>
        <li><code>AND</code> / <code>OR</code></li>
        <li><code>BETWEEN</code></li>
        <li><code>IN</code></li>
        <li><code>LIKE</code></li>
      </ul>

      <p>Exemples :</p>
      <pre><code class="language-sql">SELECT *
FROM INSCRIPTION
WHERE Note BETWEEN 10 AND 20;</code></pre>

      <pre><code class="language-sql">SELECT *
FROM ETUDIANT
WHERE Nom LIKE 'A%';</code></pre>

      <h3 id="join">3.2 JOIN : relier des tables</h3>

      <h4 id="inner-join">a) INNER JOIN (jointure interne)</h4>
      <p>Renvoie seulement les lignes qui ont une correspondance dans les deux tables.</p>
      <pre><code class="language-sql">SELECT e.NumEtu, e.Nom, f.NomFiliere
FROM ETUDIANT e
INNER JOIN FILIERE f ON e.CodeFiliere = f.CodeFiliere;</code></pre>

      <h4 id="left-join">b) LEFT JOIN (jointure externe gauche)</h4>
      <p>Renvoie tous les √©tudiants, m√™me ceux sans fili√®re (NULL c√¥t√© FILIERE).</p>
      <pre><code class="language-sql">SELECT e.NumEtu, e.Nom, f.NomFiliere
FROM ETUDIANT e
LEFT JOIN FILIERE f ON e.CodeFiliere = f.CodeFiliere;</code></pre>

      <h4 id="right-join">c) RIGHT JOIN (externe droite)</h4>
      <p>Renvoie toutes les fili√®res, m√™me celles sans √©tudiant (pas toujours support√© / utilis√©).</p>
      <pre><code class="language-sql">SELECT e.NumEtu, e.Nom, f.NomFiliere
FROM ETUDIANT e
RIGHT JOIN FILIERE f ON e.CodeFiliere = f.CodeFiliere;</code></pre>

      <h4 id="full-outer-join">d) FULL OUTER JOIN (complet)</h4>
      <p>
        Renvoie tout des deux c√¥t√©s (selon SGBD). Ex : PostgreSQL le supporte, MySQL non (il faut simuler).
      </p>

      <h3 id="subqueries">3.3 Sous-requ√™tes (Subqueries)</h3>

      <h4 id="in-subquery">Exemple : √©tudiants inscrits √† BD1 (IN)</h4>
      <pre><code class="language-sql">SELECT Nom, Prenom
FROM ETUDIANT
WHERE NumEtu IN (
  SELECT NumEtu
  FROM INSCRIPTION
  WHERE CodeCours = 'BD1'
);</code></pre>

      <h4 id="exists-subquery">Sous-requ√™te avec EXISTS</h4>
      <pre><code class="language-sql">SELECT e.Nom, e.Prenom
FROM ETUDIANT e
WHERE EXISTS (
  SELECT 1
  FROM INSCRIPTION i
  WHERE i.NumEtu = e.NumEtu
);</code></pre>

      <h2 id="groupby-having">4) Regroupement : GROUP BY, HAVING, Agr√©gation</h2>

      <h3 id="agregation">4.1 Fonctions d‚Äôagr√©gation</h3>
      <ul>
        <li><code>COUNT(*)</code> : nombre de lignes</li>
        <li><code>SUM(x)</code> : somme</li>
        <li><code>AVG(x)</code> : moyenne</li>
        <li><code>MIN(x)</code>, <code>MAX(x)</code></li>
      </ul>

      <h4 id="count-by-group">Exemple : nombre d‚Äô√©tudiants par fili√®re</h4>
      <pre><code class="language-sql">SELECT CodeFiliere, COUNT(*) AS NbEtudiants
FROM ETUDIANT
GROUP BY CodeFiliere;</code></pre>

      <h3 id="having">4.2 HAVING (filtrer apr√®s GROUP BY)</h3>
      <h4 id="having-example">Exemple : fili√®res ayant plus de 50 √©tudiants</h4>
      <pre><code class="language-sql">SELECT CodeFiliere, COUNT(*) AS NbEtudiants
FROM ETUDIANT
GROUP BY CodeFiliere
HAVING COUNT(*) > 50;</code></pre>

      <div class="callout good">
        <strong>Diff√©rence WHERE vs HAVING</strong><br/>
        <ul>
          <li><code>WHERE</code> filtre les lignes <strong>avant</strong> regroupement</li>
          <li><code>HAVING</code> filtre les groupes <strong>apr√®s</strong> regroupement</li>
        </ul>
      </div>

      <h2 id="contraintes">5) Contraintes SQL (int√©grit√©)</h2>

      <h3 id="pk">5.1 PRIMARY KEY</h3>
      <p><code>PRIMARY KEY</code> implique <strong>UNIQUE</strong> + <strong>NOT NULL</strong>.</p>
      <pre><code class="language-sql">NumEtu INT PRIMARY KEY</code></pre>

      <h3 id="fk">5.2 FOREIGN KEY</h3>
      <p>
        Assure l‚Äôint√©grit√© r√©f√©rentielle : la valeur doit exister dans la table r√©f√©renc√©e.
      </p>
      <pre><code class="language-sql">CodeFiliere VARCHAR(10),
FOREIGN KEY (CodeFiliere) REFERENCES FILIERE(CodeFiliere)</code></pre>

      <p>Avec actions :</p>
      <pre><code class="language-sql">FOREIGN KEY (CodeFiliere) REFERENCES FILIERE(CodeFiliere)
ON DELETE SET NULL
ON UPDATE CASCADE</code></pre>

      <h3 id="unique">5.3 UNIQUE</h3>
      <pre><code class="language-sql">Email VARCHAR(100) UNIQUE</code></pre>

      <h3 id="check">5.4 CHECK</h3>
      <pre><code class="language-sql">Note DECIMAL(4,2) CHECK (Note >= 0 AND Note <= 20)</code></pre>

      <h3 id="notnull">5.5 NOT NULL</h3>
      <pre><code class="language-sql">Nom VARCHAR(50) NOT NULL</code></pre>

      <h2 id="exemple-complet">6) Exemple complet : cr√©ation + contraintes + donn√©es</h2>

      <pre><code class="language-sql">CREATE TABLE FILIERE (
  CodeFiliere VARCHAR(10) PRIMARY KEY,
  NomFiliere VARCHAR(50) NOT NULL
);

CREATE TABLE ETUDIANT (
  NumEtu INT PRIMARY KEY,
  Nom VARCHAR(50) NOT NULL,
  Prenom VARCHAR(50),
  Email VARCHAR(100) UNIQUE,
  CodeFiliere VARCHAR(10),
  FOREIGN KEY (CodeFiliere) REFERENCES FILIERE(CodeFiliere)
);

INSERT INTO FILIERE VALUES ('INFO', 'Informatique');
INSERT INTO ETUDIANT VALUES (2024001, 'Alami', 'Hassan', 'h.alami@gmail.com', 'INFO');</code></pre>

      <h2 id="tp-videos">Travaux pratiques (vid√©os)</h2>
      <div class="callout good">
        <strong>TP (format vid√©o)</strong><br/>
        Ici tu peux ajouter tes vid√©os s√©par√©es : YouTube, Google Drive, ou des fichiers <code>.mp4</code> dans ton projet.
      </div>

      <h2 id="mini-quiz">Mini-quiz</h2>
      <ol>
        <li>Quelle est la diff√©rence entre DDL et DML ?</li>
        <li>Pourquoi UPDATE/DELETE sans WHERE est dangereux ?</li>
        <li>Diff√©rence entre WHERE et HAVING ?</li>
        <li>Diff√©rence entre INNER JOIN et LEFT JOIN ?</li>
        <li>Pourquoi on utilise une cl√© √©trang√®re (FOREIGN KEY) ?</li>
      </ol>

    </article>

    <aside class="sidebar">
      <div class="sidebar-title">Sommaire</div>
      <nav id="toc" class="toc"></nav>
      <div class="sidebar-footer">
        <a class="pill" href="index.html">Retour au sommaire</a>
      </div>
    </aside>
  </main>

  <script src="../js/page-toc.js"></script>
</body>
</html>
